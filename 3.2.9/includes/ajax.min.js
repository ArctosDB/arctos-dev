function uridecode(e){return decodeURIComponent(e.replace(/\+/g," "))}function confineToIframe(){if(!1===inIframe()){var e=document.createElement("div");e.id="bgDiv",e.className="bgDiv",document.body.appendChild(e),alert("Improper Access: This form should not be accessed in this way, please file an Issue.")}}function inIframe(){try{return window.self!==window.top}catch(e){return!0}}$.datepicker.setDefaults({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,constrainInput:!1,yearRange:"c-200:c+10"}),$(document).ready(function(){if("BroadcastChannel"in self)try{let e=new BroadcastChannel("session_time");var t=(new Date).getTime();e.postMessage(t),e.onmessage=function(e){postSessTime(e.data)},postSessTime(t)}catch(n){}$(".expandoSelect").on("click",function(){var e=$(this).data("ctl");if($("#"+e).prop("multiple"))$("#"+e).removeAttr("multiple").attr("size","1");else{var t=Math.min($("#"+e+" option").length,10);$("#"+e).attr("multiple","multiple").attr("size",t)}}),$(document).on("click","a[class=newWinLocal]",function(){this.target="_blank"}),$(document).on("click","a[class=external]",function(){this.target="_blank"}),$(document).on("click","a[class=handbook]",function(){this.target="_blank"}),$(document).on("click","a[class=newwin]",function(){this.target="_blank"}),$(document).on("click",".helpLink",function(e){var t=$(this).data("helplink");if(null==t)var t=this.id;$("<iframe src='/doc/get_short_doc.cfm?fld="+t+"' id='dialog' class='popupDialog' style='width:800px;height:600px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:{my:"top",at:"top+150"},title:"Documentation",width:800,height:600,close:function(){$(this).remove()}}).width(790).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}),window.self!==window.top&&($("#the_whole_header").hide(),$("#arctosfooter").hide()),$("input[type='date'], input[type='datetime']").datepicker(),window.setInterval(function(){postSessTime()},6e4)});const randomId=function(e=6){return Math.random().toString(36).substring(2,e+2)};function openOverlay(e,t="No title provided."){var n=document.createElement("a");n.href=e,rid=n.pathname.substring(n.pathname.lastIndexOf("/")+1).replace(".cfm","");var o=document.createElement("div");o.id="overlayDiv"+rid,o.className="overlayDiv",document.body.appendChild(o);var l=document.createElement("div");l.className="overlayDivHeader",l.id="overlayDivHeader",l.append(t),$("#overlayDiv"+rid).append(l);var r=document.createElement("span");r.className="closeOverlay",r.id="closeOverlay",r.setAttribute("onclick","closeOverlay('"+rid+"')"),r.append("\xd7"),$("#overlayDivHeader").append(r),$("#overlayDiv"+rid).append('<img id="overlayLoadingImg" src="/images/loadingAnimation.gif" class="centeredImage">');var d=document.createElement("iFrame");d.id="overlayiFrame",d.className="overlayiFrame",d.src=e,$("#overlayDiv"+rid).append(d),$("#overlayLoadingImg").remove()}function closeOverlay(e){$("#overlayDiv"+e).remove(),$("#overlayDiv"+e,window.parent.document).remove()}function toggleInfo(e){document.querySelector("#"+e).classList.toggle("noshow"),document.querySelector("#"+e+"_show").classList.toggle("noshow"),document.querySelector("#"+e+"_hide").classList.toggle("noshow")}function pickEscapeSingleQuoteOnly(e){return e.replace(/'/g,"\\'")}function pickEscapeQuote(e){var t=e.replace(/'/g,"\\'");return t.replace(/"/g,"`")}function convertCoords(e,t){$("<iframe src='/form/coordinateConverter.cfm?dlatfld="+e+"&dlonfld="+t+"' id='dialog' class='popupDialog' style='width:600px;height:600px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","top"],title:"Coordinate Converter",width:800,height:600,close:function(){$(this).remove()}}).width(790).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function pickTaxonConcept(e,t,n){var o;n=encodeURIComponent(n),$("#"+t).addClass("badPick"),$("<iframe src='"+("/picks/findTaxonConcept.cfm?tcidFld="+e+"&tcvFld="+t+"&name=")+(o=void 0!==n?n:"")+"' id='dialog' class='popupDialog' style='width:600px;height:600px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","top"],title:"Pick Concept",width:800,height:600,close:function(){$(this).remove()}}).width(790).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function postSessTime(e){try{if(!$("#sessExpMin").length||!$("#slcd").length)return!1;void 0!==e&&$("#slcd").val(e);var t,n=(new Date).getTime(),o=$("#slcd").val(),l=Math.round((54e5-(n-o))/6e4);l<=5&&(t="expSoon"),l<=0&&(l="NOW!",$("#signoutbuttonitem").html("<a href=\"#\" onclick=\"openOverlay('/form/loginformguts.cfm','Log in, log out, create account, or recover password.');\">Sign In</a>")),$("#sessExpMinNO").html(" ["+l+"]"),$("#sessExpMin").html(l+" minutes left in session")}catch(r){}}function createAgent(e,t,n,o,l){if(!t)var t="";if(!n)var n="";if(!o)var o="";if(!l)var l="";var r="/includes/forms/createagent.cfm?agent_type="+e+"&caller="+t+"&agentIdFld="+n+"&agentNameFld="+o+"&agentNameVal="+l;parent.$("#dialog").length?parent.$("#dialog").attr("src",r):($("<iframe src='"+r+"' id='dialog' class='popupDialog' style='width:1200px;height:800px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"New Agent",width:1200,height:800,close:function(){$(this).remove()}}).width(1190).height(790),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")}))}function pickAgentModal(e,t,n){var o;n=encodeURIComponent(n),$("#"+t).addClass("badPick"),$("<iframe src='"+("/picks/findAgentModal.cfm?agentIdFld="+e+"&agentNameFld="+t+"&name=")+(o=void 0!==n?n:"")+"' id='dialog' class='popupDialog' style='width:1200px;height:600px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","top"],title:"Pick Agent",width:1200,height:600,close:function(){$(this).remove()}}).width(1190).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function getFormattedDate(){var e=new Date;return e.getFullYear()+"-"+getFormattedPartTime(e.getMonth()+1)+"-"+getFormattedPartTime(e.getDate())}function getFormattedPartTime(e){return e<10?"0"+e:e}function fetchMediaMeta(){var e=[];$("[data-doi]").each(function(t,n){var o=$(this).attr("data-doi");e.push(o)});var t=e.join();0!=t.length&&$.ajax({url:"/component/functions.cfc?queryformat=column",type:"GET",dataType:"json",data:{method:"getPubCitSts",doilist:t,returnformat:"json"},success:function(e){"SUCCESS"==e.STATUS?$.each(e.STSARY,function(e,t){var n="<ul>";n+="<li>References Count: "+t.REFERENCE_COUNT+"</li>",n+="<li>Referenced By Count: "+t.REFERENCE_BY_COUNT+"</li>",n+='<li><a data-doi="'+t.DOI+'" href="/info/publicationDetails.cfm?doi='+t.DOI+'" class="modalink">CrossRef Data</a></li>',n+="</ul>",$("#x"+t.DOI.replace(/[\W_]+/g,"_")).append(n)}):alert(e.STATUS+": "+e.MSG)},error:function(e,t,n){alert(n+": "+t+": "+e)}})}function showPubInfo(e){$("<iframe src='/info/publicationDetails.cfm?doi="+e+"' id='dialog' class='popupDialog' style='width:800px;height:800px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"Publication Details",width:800,height:800,close:function(){$(this).remove()}}).width(790).height(790),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function addMedia(e,t){$("<iframe src='/picks/upLinkMedia.cfm?ktype="+e+"&kval="+t+"' id='dialog' class='popupDialog' style='width:600px;height:600px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"Add Media",width:800,height:600,close:function(){$(this).remove()}}).width(790).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function loadEditAgent(e){$("#agntEditCell").html('<img src="/images/indicator.gif">'),$("#agntEditCell").load("/editAllAgent.cfm?agent_id="+e,{},function(){history.pushState("data","","/agents.cfm?agent_id="+e)})}function loadAgentSearch(e){var t;$("#agntRslCell").html('<img src="/images/indicator.gif">'),$.ajax({url:"/component/api/v2/jsonutils.cfc?queryformat=column&method=findAgents&returnformat=json",type:"GET",dataType:"json",data:e,success:function(e){if(e.substring&&"error"==e.substring(0,5))return $("#agntRslCell").html('<span class="importantNotification">'+e+"</span>"),alert(e),!1;if(0===e.ROWCOUNT)return $("#agntRslCell").html('<span class="importantNotification">Nothing Matched.</span>'),!1;for(i=0,t='<div style="height:30em; overflow:auto;">';i<e.ROWCOUNT;i++)e.DATA.AGENT_ID[i]>=0?(t+='<div><span class="likeLink" onclick="loadEditAgent('+e.DATA.AGENT_ID[i]+');">',t+=e.DATA.PREFERRED_AGENT_NAME[i]+'</span><font size="-1"> (',t+=e.DATA.AGENT_TYPE[i]+": "+e.DATA.AGENT_ID[i]+")",t+=' <a target="_blank" href="/agents.cfm?agent_id='+e.DATA.AGENT_ID[i]+'">[new window]</a></font></div>'):(t+="<div>",t+=e.DATA.PREFERRED_AGENT_NAME[i]+'<font size="-1"> (',t+=e.DATA.AGENT_TYPE[i]+")",t+=' <a target="_blank" href="/search.cfm?attribute_type_1=verbatim+agent&attribute_value_1=='+e.DATA.PREFERRED_AGENT_NAME[i]+'">[CatalogRecords]</a></font>');t+="</div>",$("#agntRslCell").html(t)},error:function(e,t,n){alert(n+": "+t+": "+e)}})}function addGroupMember(){var e=parseInt($("#nnga").val())+parseInt(1),t='<div><input type="hidden" name="member_agent_id_new'+e+'" id="member_agent_id_new'+e+'">';t+='<input type="text" name="group_member_new'+e+'" id="group_member_new'+e+'"',t+=" onchange=\"pickAgentModal('member_agent_id_new"+e+"',this.id,this.value); return false;\"",t+=' onKeyPress="return noenter(event);" placeholder="new group member" class="minput"></div>',$("#newGroupMembers").append(t),$("#nnga").val(e)}function addAgentName(){var e=parseInt($("#nnan").val())+parseInt(1),t='<div id="agentnamedv'+e+'"><select name="agent_name_type_new'+e+'" id="agent_name_type_new'+e+'"></select>';t+='<input type="text" name="agent_name_new'+e+'" id="agent_name_new'+e+'" size="40" placeholder="new agent name" class="minput"></div>',$("#agentnamedv"+$("#nnan").val()).after(t),$("#agent_name_type_new1").find("option").clone().appendTo("#agent_name_type_new"+e),$("#nnan").val(e)}function addAgentStatus(){var e=parseInt($("#nnas").val())+parseInt(1),t='<div id="nas'+e+'" style="display: table-row;"><div style="display:table-cell">';t+='<select name="agent_status_new'+e+'" id="agent_status_new'+e+'" size="1"></select>',t+='</div><div style="display:table-cell"><input type="datetime" class="sinput" placeholder="status date" name="status_date_new'+e+'" id="status_date_new'+e+'"></div>',t+='<div style="display:table-cell"><textarea class="mediumtextarea" name="status_remark_new'+e+'" id="status_remark_new'+e+'" placeholder="status remark"></textarea></div></div>',$("#nas"+$("#nnas").val()).after(t),$("#agent_status_new1").find("option").clone().appendTo("#agent_status_new"+e),$("#status_date_new"+e).datepicker(),$("#nnas").val(e)}function addAgentRelationship(){var e=parseInt($("#nnar").val())+parseInt(1),t='<tr id="nar'+e+'" class="newRec">';t+='<td><select name="agent_relationship_new'+e+'" id="agent_relationship_new'+e+'" size="1"></select></td>',t+="<td>",t+='<input type="hidden" name="related_agent_id_new'+e+'" id="related_agent_id_new'+e+'">',t+='<input type="text" name="related_agent_new'+e+'" id="related_agent_new'+e+'"',t+="onchange=\"pickAgentModal('related_agent_id_new"+e+"',this.id,this.value); return false;\"",t+='onKeyPress="return noenter(event);" placeholder="pick related agent" class="">',t+="</td>",t+='<td><input type="datetime" class="sinput" placeholder="begin date" name="relationship_began_date_new'+e+'" id="relationship_began_date_new'+e+'"></td>',t+='<td><input type="datetime" class="sinput" placeholder="begin date" name="relationship_end_date_new'+e+'" id="relationship_end_date_new'+e+'"></td>',t+='<td><textarea class="tinytextarea" name="relationship_remarks_new'+e+'" placeholder="relationship remark" id="relationship_remarks_new'+e+'"></textarea></td>',t+="<td></td>",t+="</tr>",$("#nar"+$("#nnar").val()).after(t),$("#agent_relationship_new1").find("option").clone().appendTo("#agent_relationship_new"+e),$("#nnar").val(e),$("#relationship_began_date_new"+e).datepicker(),$("#relationship_end_date_new"+e).datepicker()}function addAddress(){var e=parseInt($("#nnea").val())+parseInt(1),t='<div id="eaddiv'+e+'" class="newRec">';t+='<select name="address_type_new'+e+'" id="address_type_new'+e+'" size="1"></select>',t+='<input type="text" class="minput" name="address_new'+e+'" id="address_new'+e+'" placeholder="add address">',t+='<input type="datetime" name="start_date_new'+e+'" id="start_date_new'+e+'" placeholder="start date" size="10">',t+='<input type="datetime" name="end_date_new'+e+'" id="end_date_new'+e+'" placeholder="end date" size="10">',t+='<textarea class="smalltextarea" placeholder="remark" name="address_remark_new'+e+'" id="address_remark_new'+e+'"></textarea>',t+="</div>",$("#eaddiv"+$("#nnea").val()).after(t),$("#address_type_new1").find("option").clone().appendTo("#address_type_new"+e),$("#nnea").val(e)}function rankAgent(e){$("<div id='dialog' class='popupDialog'><img src='/images/indicator.gif'></div>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"Rank Agent",width:"auto",close:function(){$(this).remove()}}).load("/includes/forms/agentrank.cfm?agent_id="+e,function(){$(this).dialog("option","position",["center","center"])}),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function editAgentAddress(e){$("<div id='dialog' class='popupDialog'><img src='/images/indicator.gif'></div>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"Edit Address",width:"auto",close:function(){$(this).remove()}}).load("includes/forms/editAgentAddr.cfm?action=editAddress&addr_id="+e,function(){$(this).dialog("option","position",["center","center"])}),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function getUrlParameter(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var o=t[n].split("=");if(o[0]==e)return o[1]}}function checkReplaceNoPrint(e,t){var n;if(0!==$("#"+t).val().length){if($("#"+t).val().indexOf("[NOPRINT]")>=0)return alert("remove [NOPRINT] from "+t),e.preventDefault(),!1;$.ajax({url:"/component/functions.cfc?queryformat=column",type:"POST",dataType:"json",async:!1,data:{method:"removeNonprinting",orig:$("#"+t).val(),userString:"[NOPRINT]",returnformat:"json"},success:function(o){if(o.DATA.REPLACED_WITH_USERSTRING[0]!=$("#"+t).val())return $("#"+t).val(o.DATA.REPLACED_WITH_USERSTRING[0]),n="The form cannot be submitted: There are nonprinting characters in "+t+".\n\n",n+="Nonprinting characters have been replaced with [NOPRINT]. Remove that to continue.\n\n",alert(n+="You may use HTML markup for print control: <br> is linebreak"),e.preventDefault(),!1},error:function(t,n,o){return alert(o+": "+n+": "+t),e.preventDefault(),!1}})}}function setSessionCustomID(e){$.getJSON("/component/functions.cfc",{method:"setSessionCustomID",val:e,returnformat:"json",queryformat:"column"},function(e){})}function jqueryspecialescape(e){return e.replace(/[ !"#$%&'()*+,.\/:;<=>?@^`{|}~]/g,"\\$&")}function checkCSV(e){var t,n;"csv"!=(n=(t=e.value).substring(t.lastIndexOf(".")+1).toLowerCase())?(alert("Only files with the file extension CSV are allowed"),$("input[type=submit]").hide()):$("input[type=submit]").show()}function getMedia(e,t,n,o,l){var r;$("#"+n).find($("#imgBrowserCtlDiv")).append('<img src="/images/indicator.gif">'),r="/form/inclMedia.cfm?typ="+e+"&q="+t+"&tgt="+n+"&rpp="+o+"&pg="+l,$.get(r,function(e){$("#"+n).html(e)})}function findPart(e,t,n){var o,l;l=(o="/picks/findPart.cfm")+"?part_name="+(t=t.replace("%","_"))+"&guid_prefix="+n+"&partFld="+e,partpick=window.open(l,"","width=800,height=600, resizable,scrollbars")}function isValidEmailAddress(e){var t;return(t=RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i)).test(e)}function saveThisAnnotation(){var e,t,n,o,l;return(e=document.getElementById("idtype").value,t=document.getElementById("idvalue").value,n=document.getElementById("annotation").value,o=$("#captchaHash").val(),l=$("#captcha").val().toUpperCase(),n.length<=20)?(alert("You must enter an annotation of at least 20 characters to save."),!1):isValidEmailAddress($("#email").val())?void($("#annotateDiv").append('<div id="svgol" style="float:left;position:absolute;top:0;width:100%;height:100%;background-color:rgba(128,128,128,0.5);padding-left:50%;padding-top:20%;"><img src="/images/indicator.gif"></div>'),$.ajax({url:"/component/functions.cfc",type:"POST",dataType:"json",data:{method:"hashString",string:l,returnformat:"json"},success:function(o){$.ajax({url:"/component/functions.cfc",type:"POST",dataType:"json",data:{method:"addAnnotation",idType:e,idvalue:t,annotation:n,email:$("#email").val(),returnformat:"json",queryformat:"column"},success:function(e){return"success"==e?($("#svgol").remove(),alert("Your annotations have been saved, and the appropriate curator will be alerted. \n Thank you for helping improve Arctos!"),closeAnnotation()):($("#svgol").remove(),alert("An error occured! \n "+e)),!0},error:function(e,t,n){console.log(n+": "+t+": "+e)}})},error:function(e,t,n){console.log(n+": "+t+": "+e)}})):(alert("Enter a valid email address."),!1)}function openAnnotation(e){$("<iframe src='/info/annotate.cfm?q="+e+"' id='dialog' class='popupDialog' style='width:600px;height:600px;'></iframe>").prop("id","dialog").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"Report Bad Data",width:800,height:600,close:function(){$(this).remove()}}).width(790).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function closeAnnotation(){parent.$(".ui-dialog-titlebar-close").trigger("click")}function archiveRecords(e){if(p="Archive search RESULTS. Use Save Search to save CRITERIA.\n",p+=" Type a name for the archive. Names must consist only of lower-case letters, numbers, dash (-), and underbar (_).\n",p+=" The process will take a few seconds; hang tight until you get a confirmation.\n",p+="'myarchive' will create a new archive (or fail); '+myarchive' will append to your existing archive 'myarchive' (or fail).",!(sName=prompt(p)))return!1;$.getJSON("/component/functions.cfc",{method:"archiveSpecimen",archive_name:sName,table_name:e,returnformat:"json",queryformat:"column"},function(e){alert(e)})}function lockArchive(e){if(!0!==confirm("Are you sure you want to lock this Archive?"))return!1;jQuery.getJSON("/component/functions.cfc",{method:"lockArchive",archive_name:e,returnformat:"json",queryformat:"column"},function(e){alert(e)})}function changeCollection(e){jQuery.getJSON("/component/functions.cfc",{method:"changeexclusive_collection_id",tgt:"",returnformat:"json",queryformat:"column"},function(t){document.location=e})}function saveSearch(e,t){var n,o,l,r,d;n=Date.now(),void 0!==t&&t.length>0&&(d="ERROR: "+t+"\n\n"),d="Saving search for URL:\n\n"+e+" \n\nName your saved search (or copy and ",d+="paste the link above).\n\nManage or email saved searches from your profile, or go to /saved/{name of saved search}. Note ",d+="that saved searches, except those sepecifying only GUIDs, are dynamic; results change as data changes.\n\nName of saved search (must be unique):\n",null!==(o=prompt(d,n))&&(l=encodeURIComponent(o),r=e,$.getJSON("/component/functions.cfc",{method:"saveSearch",returnURL:r,srchName:l,returnformat:"json",queryformat:"column"},function(t){if("success"!=t){if(alert(t),"You must create an account or log in to save searches."==t)return!1;saveSearch(e,t)}else alert("Saved search \n"+(url=(protocol=(pathArray=window.location.href.split("/"))[0])+"//"+(host=pathArray[2]))+"/saved/"+l+"\n Find it in your username tab.")}))}function addPartToContainer(){var e,t,n,o,l;if(document.getElementById("pTable").className="red",e=document.getElementById("collection_object_id").value,t=document.getElementById("part_name").value,n=document.getElementById("part_name_2").value,o=document.getElementById("parent_barcode").value,l=document.getElementById("new_container_type").value,0===e.length||0===t.length||0===o.length)return alert("Something is null"),!1;$.getJSON("/component/functions.cfc",{method:"addPartToContainer",collection_object_id:e,part_id:t,part_id2:n,parent_barcode:o,new_container_type:l,returnformat:"json",queryformat:"column"},function(e){var t=(statAry=e.split("|"))[0],n=statAry[1];document.getElementById("pTable").className="";var o=document.getElementById("msgs"),l=document.getElementById("msgs_hist"),r=o.innerHTML+"<hr>"+l.innerHTML;l.innerHTML=r,o.innerHTML=n,0===t?o.className="error":(o.className="successDiv",document.getElementById("oidnum").focus(),document.getElementById("oidnum").select(),getParts())})}function clonePart(){var e=document.getElementById("collection_id").value,t=document.getElementById("other_id_type").value,n=document.getElementById("oidnum").value;e.length>0&&t.length>0&&n.length>0?$.getJSON("/component/functions.cfc",{method:"getSpecimen",collection_id:e,other_id_type:t,oidnum:n,returnformat:"json",queryformat:"column"},function(e){toString(e.DATA.COLLECTION_OBJECT_ID[0]).indexOf("Error:")>-1?alert(e.DATA.COLLECTION_OBJECT_ID[0]):newPart(e.DATA.COLLECTION_OBJECT_ID[0])}):alert("Error: cannot resolve ID to specimen.")}function checkSubmit(){var e;!0===(e=document.getElementById("submitOnChange").checked)&&addPartToContainer()}function newPart(e){var t,n;collection_id=document.getElementById("collection_id").value,t=document.getElementById("part_name").value,n="/form/newPart.cfm",n+="?collection_id="+collection_id,n+="&collection_object_id="+e,divpop(n+="&part="+t)}function getParts(){var e,t,n,o,l,r,d,s,u,g,m,h,f,v,y,b,E,w,k,F;e=document.getElementById("collection_id").value,t=document.getElementById("other_id_type").value,n=document.getElementById("oidnum").value,e.length>0&&t.length>0&&n.length>0&&((o=document.createElement("DIV")).id="ajaxStatus",o.className="ajaxStatus",o.innerHTML="Fetching parts...",document.body.appendChild(o),l=document.getElementById("noBarcode").checked,r=document.getElementById("noSubsample").checked,$.getJSON("/component/functions.cfc",{method:"getParts",collection_id:e,other_id_type:t,oidnum:n,noBarcode:l,noSubsample:r,returnformat:"json",queryformat:"column"},function(e){if(d=e.DATA,o=document.getElementById("ajaxStatus"),document.body.removeChild(o),s=document.getElementById("thisSpecimen"),u=document.getElementById("collection_id"),g=document.getElementById("collection_object_id"),m=document.getElementById("part_name"),h=document.getElementById("part_name_2"),f=m.value,v=h.value,m.options.length=0,h.options.length=0,y=u.selectedIndex,b=u.options[y].text,k=b+" "+(E=document.getElementById("other_id_type").value)+" "+(w=document.getElementById("oidnum").value),d.PART_NAME[0].indexOf("Error:")>-1)s.className="error",k+=" = "+d.PART_NAME[0],g.value="",document.getElementById("pTable").className="red";else{for(document.getElementById("pTable").className="",s.className="",g.value=d.COLLECTION_OBJECT_ID[0],(F=document.createElement("option")).setAttribute("value",""),F.appendChild(document.createTextNode("")),h.appendChild(F),i=0;i<e.ROWCOUNT;i++)F=document.createElement("option"),option2=document.createElement("option"),F.setAttribute("value",d.PARTID[i]),option2.setAttribute("value",d.PARTID[i]),pStr=d.PART_NAME[i],null!==d.BARCODE[i]&&(pStr+=" ["+d.BARCODE[i]+"]"),F.appendChild(document.createTextNode(pStr)),option2.appendChild(document.createTextNode(pStr)),m.appendChild(F),h.appendChild(option2);m.value=f,h.value=v,k+=' = <a target="_blank" href="/guid/'+d.COLLECTION[0]+":"+d.CAT_NUM[0]+'">',k+=d.COLLECTION[0]+":"+d.CAT_NUM[0]+"</a>",k+=" ("+d.CUSTOMIDTYPE[0]+" "+d.CUSTOMID[0]+")"}s.innerHTML=k}))}function divpop(e){var t,n,o;(n=document.createElement("div")).id="bgDiv",n.className="bgDiv",document.body.appendChild(n),(o=document.createElement("div")).id="ppDiv",o.className="pickBox",o.innerHTML="Loading....",o.src="",document.body.appendChild(o),window.XMLHttpRequest?t=new XMLHttpRequest:window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLHTTP")),void 0!==t&&(t.onreadystatechange=function(){divpopDone(t)},t.open("GET",e,!0),t.send(""))}function divpopDone(e){if(4==e.readyState){200==e.status?document.getElementById("ppDiv").innerHTML=e.responseText:document.getElementById("ppDiv").innerHTML="ahah error:\n"+e.statusText;var t=document.getElementById("ppDiv"),n=document.createElement("span");n.className="popDivControl",n.setAttribute("onclick","divpopClose();"),n.innerHTML="X",t.appendChild(n)}}function divpopClose(){var e=document.getElementById("ppDiv");document.body.removeChild(e);var t=document.getElementById("bgDiv");document.body.removeChild(t)}function makePart(){var e,t,n,o,l,r,d,s,u,g,m,h,f;e=document.getElementById("collection_object_id").value,t=document.getElementById("npart_name").value,n=document.getElementById("part_count").value,o=document.getElementById("disposition").value,l=document.getElementById("condition").value,r=document.getElementById("part_remark").value,d=document.getElementById("barcode").value,s=document.getElementById("new_container_type").value,$.getJSON("/component/functions.cfc",{method:"makePart",collection_object_id:e,part_name:t,part_count:n,disposition:o,condition:l,part_remark:r,barcode:d,new_container_type:s,returnformat:"json",queryformat:"column"},function(e){"error"==(g=(u=e.DATA).STATUS[0])?alert(m=u.MSG[0]):(m="Created part: ",m+=u.PART_NAME[0]+" ",null!==u.BARCODE[0]&&(m+="barcode "+u.BARCODE[0],null!==u.NEW_CONTAINER_TYPE[0]&&(m+="( "+u.NEW_CONTAINER_TYPE[0]+")")),h=document.getElementById("ppDiv"),document.body.removeChild(h),f=document.getElementById("bgDiv"),document.body.removeChild(f),getParts())})}function changecustomOtherIdentifier(e){$.getJSON("/component/functions.cfc",{method:"changecustomOtherIdentifier",tgt:e,returnformat:"json",queryformat:"column"},function(e){"success"==e?document.getElementById("customOtherIdentifier").className="":alert("An error occured: "+e)})}function IsNumeric(e){var t,n=!0;for(i=0;i<e.length&&!0===n;i++)t=e.charAt(i),-1=="0123456789.".indexOf(t)&&(n=!1);return n}function orapwCheck(e,t){var n=/^[A-Za-z0-9!$%&_?(\-)<>=/:;*\.]$/,o="Password is acceptable";e.indexOf(t)>-1&&(o="Password may not contain your username."),(e.length<6||e.length>30)&&(o="Password must be between 6 and 30 characters."),e.match(/[a-zA-Z]/)||(o="Password must contain at least one letter."),e.match(/\d+/)||(o="Password must contain at least one number."),e.match(/[!,$,%,&,*,?,_,-,(,),<,>,=,/,:,;,.]/)||(o="Password must contain at least one of: !,$,%,&,*,?,_,-,(,),<,>,=,/,:,;.");for(var l=0;l<e.length;l++)e.charAt(l).match(n)||(o="Password may contain only A-Z, a-z, 0-9, and !$%&_?(-)<>=/:;*.");return o}function getCtDocVal(e,t){var n="/info/ctDocumentation.cfm?table="+e;if(t)var o=$("#"+t).val();else var o="";o.length>0&&(n+="#"+o.replace(/[^0-9a-zA-Z]/g,"_").toLowerCase()),windowOpener(n,"ctDocWin","width=700,height=400, resizable,scrollbars")}function getCtDoc(e,t){var n="/info/ctDocumentation.cfm?table="+e;void 0!==t&&(n+="#"+t.replace(/[^0-9a-zA-Z]/g,"_").toLowerCase()),windowOpener(n,"ctDocWin","width=700,height=400, resizable,scrollbars")}function windowOpener(e,t,n){"object"!=typeof(popupWins=[])[t]?popupWins[t]=window.open(e,t,n):popupWins[t].closed?popupWins[t]=window.open(e,t,n):popupWins[t].location.href=e,popupWins[t].focus()}function noenter(e){var t;return 13!=(t=window.event?window.event.keyCode:e.which)}function getLoan(e,t,n,o){var l,r;r=(l="/picks/getLoan.cfm")+"?LoanIDFld="+e+"&LoanNumberFld="+t+"&loanNumber="+n+"&agent_name="+o,loanpickwin=window.open(r,"","width=400,height=338, resizable,scrollbars")}function pickSpecEvtLnk(e,t,n){$("<iframe src='"+("/picks/linkSpecimenEvent.cfm?collection_object_id="+e+"&rel_key_typ="+t)+"&rel_key_val="+n+"' id='dialog' class='popupDialog' style='width:600px;height:600px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","top"],title:"Pick Linked Event",width:800,height:600,close:function(){$(this).remove()}}).width(790).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function addPermitToTrans(e,t){$("<iframe src='/picks/PermitPick.cfm?transaction_id="+e+"&callbackfunction="+t+"' id='dialog' class='popupDialog' style='width:1200px;height:600px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"Pick Agent",width:1200,height:600,close:function(){$(this).remove()}}).width(1190).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function getPublication(e,t,n){var o=encodeURIComponent(n);o=o.replace(/[!'()*]/g,escape),$("#"+e).addClass("badPick");var l="/picks/findPublication.cfm?pubStringFld="+e+"&publication_title="+o;$("<iframe src='"+(l+="&pubIdFld="+t)+"' id='dialog' class='popupDialog' style='width:600px;height:600px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"Find Publication",width:800,height:600,close:function(){$(this).remove()}}).width(790).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function getAgent(e,t,n,o,l){var r,d;d=(r="/picks/findAgent.cfm")+"?agentIdFld="+e+"&agentNameFld="+t+"&formName="+n+"&agent_name="+o+"&allowCreation="+l,agentpickwin=window.open(d,"","width=400,height=338, resizable,scrollbars")}function getProject(e,t,n,o){var l,r;r=(l="/picks/findProject.cfm")+"?projIdFld="+e+"&projNameFld="+t+"&formName="+n+"&project_name="+o,projpickwin=window.open(r,"","width=400,height=338, resizable,scrollbars")}function findCatalogedItem(e,t,n,o,l,r){var d,s;s=(d="/picks/findCatalogedItem.cfm")+"?collIdFld="+e+"&CatNumStrFld="+t+"&formName="+n+"&oidType="+o+"&oidNum="+l+"&collID="+r,catItemWin=window.open(s,"","width=400,height=338, resizable,scrollbars")}function pickCollectingEvent(e,t,n){$("#"+t).addClass("badPick"),$("<iframe src='"+("/place.cfm?sch=collecting_event&specop=pick_collecting_event&dispfld="+t+"&idfld="+e)+"&collecting_event_name="+n+"' id='dialog' class='popupDialog' style='width:1200px;height:800px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:{my:"top",at:"top+150"},title:"Pick Event",width:1200,height:800,close:function(){$(this).remove()}}).width(1190).height(790),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function pickLocality(e,t,n){$("#"+t).addClass("badPick"),$("<iframe src='"+("/place.cfm?sch=locality&specop=pick_locality&dispfld="+t+"&idfld="+e)+"&locality_name="+n+"' id='dialog' class='popupDialog' style='width:1200px;height:800px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:{my:"top",at:"top+150"},title:"Pick Locality",width:1200,height:800,close:function(){$(this).remove()}}).width(1190).height(790),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function GeogPickold(e,t,n,o){var l,r;r=(l="/picks/GeogPick2.cfm")+"?geogIdFld="+e+"&highGeogFld="+t+"&formName="+n+"&srchstring="+o,geogpick=window.open(r,"","width=600,height=600, toolbar,resizable,scrollbars,")}function pickGeography(e,t,n){$("#"+t).addClass("badPick"),$("<iframe src='"+("/place.cfm?sch=geog&specop=pick_geog&hasGeoWKT=yes&valid_catalog_term_fg=1&dispfld="+t+"&idfld="+e)+"&any_geog="+n+"' id='dialog' class='popupDialog' style='width:1200px;height:800px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:{my:"top",at:"top+150"},title:"Pick Geography",width:1200,height:800,close:function(){$(this).remove()}}).width(1190).height(790),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function getAccn(e,t,n){var o="/picks/findAccn.cfm?r_accnNumber="+e+"&rtnFldID="+t+"&r_InstAcrColnCde="+n;o=window.open(o,"","width=400,height=338, resizable,scrollbars")}function getAccnMedia(e,t){var n,o;o=(n="/picks/getAccnMedia.cfm")+"?idOfTxtFld="+e+"&idOfPKeyFld="+t,o=window.open(o,"","width=400,height=338, resizable,scrollbars")}function getAccn2(e,t){var n,o;o=(n="/picks/getAccn.cfm")+"?accnNumber="+e+"&collectionID="+t,o=window.open(o,"","width=400,height=338, resizable,scrollbars")}function getGeog(e,t,n,o){var l,r;r=(l="/picks/GeogPick2.cfm")+"?geogIdFld="+e+"&highGeogFld="+t+"&formName="+n+"&srchstring="+o,geogpick=window.open(r,"","width=600,height=600, toolbar,resizable,scrollbars,")}function getGeog__oldnbusted(e,t,n,o){var l,r;r=(l="/picks/findHigherGeog.cfm")+"?geogIdFld="+e+"&geogStringFld="+t+"&formName="+n+"&geogString="+o,geogpickwin=window.open(r,"","width=400,height=338, resizable,scrollbars")}function confirmDelete(e,t){var n;if(!0!==(n=confirm("Are you sure you want to delete "+(t=t||"this record")+"?")))return!1;document[e].submit()}function getQuadHelp(){helpWin=windowOpener("/info/quad.cfm","quadHelpWin","width=800,height=600, resizable,scrollbars,status")}function getLegal(e){helpWin=windowOpener("/info/legal.cfm?content="+e,"legalWin","width=400,height=338, resizable,scrollbars")}function findMedia(e,t,n){var o,l;l=(o="/picks/findMedia.cfm")+"?mediaIdFld="+t+"&mediaStringFld="+e+"&media_uri="+n,mediapick=window.open(l,"","width=400,height=338, resizable,scrollbars")}function taxaPick(e,t,n,o){var l,r;r=(l="/picks/TaxaPick.cfm")+"?taxonIdFld="+e+"&taxonNameFld="+t+"&formName="+n+"&scientific_name="+o,taxapick=window.open(r,"","width=1200,height=800, resizable,scrollbars")}function CatItemPick(e,t,n,o){var l,r,d;r=(l="/picks/CatalogedItemPick.cfm")+"?collIdFld="+e+"&catNumFld="+t+"&formName="+n+"&sciNameFld="+o,d=window.open(r,"","width=400,height=338, resizable,scrollbars")}function findAgentName(e,t,n){var o,l;l=(o="/picks/findAgentName.cfm")+"?agentIdFld="+e+"&agentNameFld="+t+"&agentName="+n,agentpick=window.open(l,"","width=400,height=338, resizable,scrollbars")}function addrPick(e,t,n){var o,l;l=(o="/picks/AddrPick.cfm")+"?addrIdFld="+e+"&addrFld="+t+"&formName="+n,addrpick=window.open(l,"","width=400,height=338, resizable,scrollbars")}function findJournal(e,t,n,o){var l,r,d;r=(l="/picks/findJournal.cfm")+"?journalIdFld="+e+"&journalNameFld="+t+"&formName="+n+"&journalName="+o,d=window.open(r,"","width=400,height=338, toolbar,location,status,menubar,resizable,scrollbars,")}function deleteEncumbrance(e,t){var n,o,l;o=(n="/picks/DeleteEncumbrance.cfm")+"?encumbrance_id="+e+"&collection_object_id="+t,l=window.open(o,"","width=400,height=338, toolbar,location,status,menubar,resizable,scrollbars,")}function getAllSheets(){var e,t,n,o;if(!window.ScriptEngine&&navigator.__ice_version)return document.styleSheets;if(document.getElementsByTagName)e=document.getElementsByTagName("LINK"),t=document.getElementsByTagName("STYLE");else{if(!document.styleSheets||!document.all)return[];e=document.all.tags("LINK"),t=document.all.tags("STYLE")}for(o=0,os=[];e[o];o++)"string"==typeof(n=e[o].rel?e[o].rel:e[o].getAttribute?e[o].getAttribute("rel"):"")&&n.toLowerCase().indexOf("style")+1&&(os[os.length]=e[o]);for(o=0;t[o];o++)os[os.length]=t[o];return os}function changeStyle(){var e,t;for(e=0,ss=getAllSheets();ss[e];e++)for(ss[e].title&&(ss[e].disabled=!0),t=0;t<arguments.length;t++)ss[e].title==arguments[t]&&(ss[e].disabled=!1);ss.length||alert("Your browser cannot change stylesheets")}function toProperCase(e){var t=document.getElementById(e);t.value.length;var n=t.selectionStart,o=t.selectionEnd,l=t.value.substring(n,o).toLowerCase().replace(/^(.)|\s(.)/g,function(e){return e.toUpperCase()}),r=t.value.substring(0,n),d=t.value.substring(o,t.value.length);t.value=r+l+d}function italicize(e){var t=document.getElementById(e),n=t.value.length,o=t.selectionStart,l=t.selectionEnd,r=t.value.substring(o,l);r.length>0&&(t.value=t.value.substring(0,o)+"<i>"+r+"</i>"+t.value.substring(l,n))}function bold(e){var t=document.getElementById(e),n=t.value.length,o=t.selectionStart,l=t.selectionEnd,r=t.value.substring(o,l);r.length>0&&(t.value=t.value.substring(0,o)+"<b>"+r+"</b>"+t.value.substring(l,n))}function superscript(e){var t=document.getElementById(e),n=t.value.length,o=t.selectionStart,l=t.selectionEnd,r=t.value.substring(o,l);r.length>0&&(t.value=t.value.substring(0,o)+"<sup>"+r+"</sup>"+t.value.substring(l,n))}function subscript(e){var t=document.getElementById(e),n=t.value.length,o=t.selectionStart,l=t.selectionEnd,r=t.value.substring(o,l);r.length>0&&(t.value=t.value.substring(0,o)+"<sub>"+r+"</sub>"+t.value.substring(l,n))}function setPartAttOptions(e,t){var n,o,l,r,d,s;$.getJSON("/component/functions.cfc",{method:"getPartAttOptions",returnformat:"json",patype:t},function(t){if(n=t.TYPE,o="attribute_value_"+e,r="attribute_units_"+e,"unit"==t.TYPE){for(l='<input type="text" name="'+o+'" id="'+o+'">',$("#v_"+e).html(l),d=t.VALUES.split("|"),l='<select name="'+r+'" id="'+r+'">',a=0;a<d.length;++a)l+='<option value="'+d[a]+'">'+d[a]+"</option>";l+="</select>",$("#u_"+e).html(l)}else if("value"==t.TYPE){for(a=0,d=t.VALUES.split("|"),l='<select name="'+o+'" id="'+o+'">';a<d.length;++a)l+='<option value="'+d[a]+'">'+d[a]+"</option>";l+="</select>",$("#v_"+e).html(l),$("#u_"+e).html("")}else s='<textarea name="'+o+'" id="'+o+'" class="smalltextarea"></textarea>',$("#v_"+e).html(s),$("#u_"+e).html("")})}function mgPartAtts(e){addBGDiv("closePartAtts()");var t=document.createElement("iFrame");t.id="partsAttDiv",t.className="annotateBox",t.innerHTML="<br>Loading...",document.body.appendChild(t),t.src="/form/partAtts.cfm?partID="+e}function closePartAtts(){$("#bgDiv").remove(),$("#partsAttDiv").remove(),$("#bgDiv",window.parent.document).remove(),$("#partsAttDiv",window.parent.document).remove()}function removeUpload(){document.getElementById("uploadDiv")&&$("#uploadDiv").remove(),removeBgDiv()}function closeUpload(e,t){document.getElementById("media_uri").value=e,document.getElementById("preview_uri").value=t;var n=e.split(".").pop();"jpg"==n||"jpeg"==n?($("#mime_type").val("image/jpeg"),$("#media_type").val("image")):"pdf"==n?($("#mime_type").val("application/pdf"),$("#media_type").val("text")):"mp3"==n?($("#mime_type").val("audio/mpeg3"),$("#media_type").val("audio")):"wav"==n?($("#mime_type").val("audio/x-wav"),$("#media_type").val("audio")):"dng"==n?($("#mime_type").val("image/dng"),$("#media_type").val("image")):"png"==n?($("#mime_type").val("image/png"),$("#media_type").val("image")):"tif"==n||"tiff"==n?($("#mime_type").val("image/tiff"),$("#media_type").val("image")):"htm"==n||"html"==n?($("#mime_type").val("text/html"),$("#media_type").val("")):"txt"==n?($("#mime_type").val("text/plain"),$("#media_type").val("text")):"mp4"==n&&($("#mime_type").val("video/mp4"),$("#media_type").val("video")),removeUpload()}function generateMD5(){var e;$.getJSON("/component/functions.cfc",{method:"genMD5",uri:$("#media_uri").val(),returnformat:"json",queryformat:"column"},function(t){addLabel(e=parseInt($("#number_of_labels").val())+parseInt(1)),$("#label__"+e).val("MD5 checksum"),$("#label_value__"+e).val(t)})}function closePreviewUpload(e){var t=document.getElementById("uploadDiv");document.body.removeChild(t),document.getElementById("preview_uri").value=e}function pickedRelationship(e){var t=document.getElementById(e).value,n=e.lastIndexOf("__"),o=e.substring(n+2,e.length),l=t.split(" "),r=l[l.length-1],d="related_id__"+o,s="related_value__"+o;document.getElementById(d).value="",document.getElementById(s).value="",""===r||("agent"==r?pickAgentModal(d,s,""):"locality"==r?LocalityPick(d,s,"newMedia"):"collecting_event"==r?pickCollectingEvent(d,s,""):"cataloged_item"==r?findCatalogedItem(d,s,"newMedia"):"project"==r?getProject(d,s,"newMedia"):"taxon_name"==r?taxaPick(d,s,"newMedia"):"publication"==r?getPublication(s,d,""):"accn"==r?getAccnMedia(s,d):"media"==r?findMedia(s,d):"loan"==r?getLoan(d,s):"permit"==r?alert("Edit permit to add Media"):"delete"==r?document.getElementById(s).value="Marked for deletion.....":alert("Something is broken. I have no idea what to do with a relationship to "+r))}function addRelation(e){var t,n,o,l,r,d,s,u,g,m,h,f,v;t=document.getElementById("relationships"),(n=document.createElement("div")).id="relationshipDiv__"+e,t.appendChild(n),l="relationship__"+(o=e-1),(r=document.getElementById(l).cloneNode(!0)).name="relationship__"+e,r.id="relationship__"+e,r.value="delete",n.appendChild(r),(c=document.createElement("textNode")).innerHTML=":&nbsp;",n.appendChild(c),d="related_value__"+(o=e-1),(s=document.getElementById(d).cloneNode(!0)).name="related_value__"+e,s.id="related_value__"+e,s.value="",n.appendChild(s),u="related_id__"+o,(g=document.getElementById(u).cloneNode(!0)).name="related_id__"+e,g.id="related_id__"+e,n.appendChild(g),m=document.getElementById("addRelationship"),t.removeChild(m),f="addRelation("+(h=e+1)+")",m.setAttribute("onclick",f),t.appendChild(m),(v=document.getElementById("number_of_relations")).value=parseInt(v.value)+1}function addLabel(e){var t,n,o,l,r,d,s,u,g,m,h;t=document.getElementById("labels"),(n=document.createElement("div")).id="labelsDiv__"+e,t.appendChild(n),l="label__"+(o=e-1),(r=document.getElementById(l).cloneNode(!0)).name="label__"+e,r.id="label__"+e,r.value="",n.appendChild(r),(c=document.createElement("textNode")).innerHTML=":&nbsp;",n.appendChild(c),d="label_value__"+o,(s=document.getElementById(d).cloneNode(!0)).name="label_value__"+e,s.id="label_value__"+e,s.value="",n.appendChild(s),u=document.getElementById("addLabel"),t.removeChild(u),m="addLabel("+(g=e+1)+")",u.setAttribute("onclick",m),t.appendChild(u),(h=document.getElementById("number_of_labels")).value=parseInt(h.value)+1}function saveAgentRank(){$.getJSON("/component/functions.cfc",{method:"saveAgentRank",agent_id:$("#agent_id").val(),agent_rank:$("#agent_rank").val(),remark:$("#remark").val(),transaction_type:$("#transaction_type").val(),returnformat:"json",queryformat:"column"},function(e){if(e.length>0&&"fail"==e.substring(0,4))alert(e);else{var t='<tr id="tablr'+e+'"><td>'+$("#agent_rank").val()+"</td>";t+="<td>"+$("#transaction_type").val()+"</td>",t+="<td>- just now - </td>",t+='<td>- you - <span class="infoLink" onclick="revokeAgentRank(\''+e+"');\">revoke</span></td>",t+="<td>"+$("#remark").val()+"</td></tr>",$("#agntRankTbl").append(t)}})}function revokeAgentRank(e){$.getJSON("/component/functions.cfc",{method:"revokeAgentRank",agent_rank_id:e,returnformat:"json",queryformat:"column"},function(t){t.length>0&&"fail"==t.substring(0,4)?alert(t):$("#tablr"+e).remove()})}function removeMediaMultiCatItem(){$("#bgDiv").remove(),$("#pickFrame").remove()}function manyCatItemToMedia(e){var t=document.createElement("div");t.id="bgDiv",t.className="bgDiv",t.setAttribute("onclick","removeMediaMultiCatItem()"),document.body.appendChild(t),$('<iframe id="pickFrame" name="pickFrame" class="pickDiv" src="/includes/forms/manyCatItemToMedia.cfm?media_id='+e+'">').appendTo("body")}function pickThis(e,t,n,o){document.getElementById(e).value=n,document.getElementById(t).value=o,document.getElementById(e).className="goodPick",removePick()}function removePick(){document.getElementById("pickDiv")&&$("#pickDiv").remove(),removeBgDiv()}function addBGDiv(e){var t=document.createElement("div");t.id="bgDiv",t.className="bgDiv",(null===e||0===e.length)&&(e="removeBgDiv()"),t.setAttribute("onclick",e),document.body.appendChild(t)}function removeBgDiv(){document.getElementById("bgDiv")&&$("#bgDiv").remove()}function deleteAgent(e){$("#author_name"+e).addClass("red").val("deleted"),$("#authortr"+e+" td:nth-child(1)").addClass("red"),$("#authortr"+e+" td:nth-child(3)").addClass("red")}